{% extends "base.html" %} 
{% load crispy_forms_tags %}
{% load markdown_deux_tags %}
{% block content %}
<div class="col-sm-8  card  mt-2 mb-5 pt-2 pb-2 pr-2 pl-2 col-sm-offset-3">
  <div class="caption">
    <h1>
      {{ instance.title }}
    </h1>
    {% if instance.image %}

    <img src="{{ instance.image.url }}" class="img-fluid" />
    {% endif %}
    <p>Read  Time : {{ instance.read_time|time:'i' }} min</p>
    <small class="faded">{{ instance.timestamp }} </small>
    {% if instance.user %}
    <p>Author : {{ instance.user }}</p>
    {% endif %} Share on
    <a
      class="twitterlink"
      href="https://twitter.com/home?status={{ object.text }}%20{{
        request.build_absolute_uri
      }}"
    >
      Twitter
    </a>
    <a
      class="glink"
      href="https://plus.google.com/share?url=http://codingforentrepreneurs.com"
    >
      Google+</a
    >
    <a
      class="linkedinlink"
      href="https://www.linkedin.com/shareArticle?mini=true&url={{
        request.build_absolute_uri
      }}&title={{ post.text }}20me!&source={{ request.build_absolute_uri }}"
    >
      Linkedin
    </a>

    <p id="content" class="content-markdown mt-2 mb-2 mr-2 ml-2">
      {{ instance.content|markdown|linebreaks }}
    </p>
    
    <div class="comments">
      <p class="lead">Comments</p>
      <form action="." method="POST">
          {% csrf_token %}
          {{ comment_form|crispy }}
          <input type="submit" value="Post Comments">
    
        </form>
      {% for comment in comments %}

        <blockquote class="blockquote">{{comment.comentText }}
        <footer class="blockquote-footer">via {{ comment.user }}| {{comment.timestamp|timesince }} ago 
          {% if comment.childrens.count > 0 %} {{ comment.childrens.count }} Comments | {% endif %}
          <a class="comment-reply-btn" href="#">Reply</a> |
          <a  href="{{ comment.get_absolute_url }}">Thread</a><br>
          {% if user ==  comment.user %} 
          <a href="{% url 'comments:comment_delete' comment.id %}" class="pull-right"><span class="badge badge-danger mt-2 mb-2">Delete</span></i></a> 
          {% endif %}
          
        </footer>
        <div class="comment-reply" style="display: none">
          {% for child_comment in comment.childrens %}
          <blockquote class="blockquote">{{child_comment.comentText }}
         <footer class="blockquote-footer">via {{ child_comment.user }}| {{child_comment.timestamp|timesince }} ago</footer>
        </blockquote>
        {% endfor %}
      <form action="." method="POST">
          {% csrf_token %}
          {{ comment_form|crispy }}
          <input type="hidden"  name="parent_id" value="{{ comment.id }}">
          <input type="submit" value="Reply ">
        </form>

        </blockquote>
        <hr/>
    </div>
      {% endfor %}
  
  </div>
</div>
{% endblock content %}
